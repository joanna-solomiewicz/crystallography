---
title: "Crystallography"
author: "Joanna So³omiewicz"
date: "15 listopada 2018"
output: 
  html_document: 
    theme: spacelab
    toc: yes
    toc_float: yes
---

#Loading libraries
```{r loading libraries, message = FALSE}
library(dplyr)
library(ggplot2)
library(plotly)
```

#Reading data
```{r reading data, cache = TRUE}
data <- read.csv2('./all_summary.csv', nrows = 10000)
dim(data)
```

#Deleting chosen ligands
```{r deleting chosen ligands}
deletable_res_name <- c("UNK", "UNX", "UNL", "DUM", "N", "BLOB", "ALA", "ARG", "ASN", "ASP", "CYS", "GLN", "GLU", "GLY", "HIS", "ILE", "LEU", "LYS", "MET", "MSE", "PHE", "PRO", "SEC", "SER", "THR", "TRP", "TYR", "VAL", "DA", "DG", "DT", "DC", "DU", "A", "G", "T", "C", "U", "HOH", "H20", "WAT")
data <- data[!data$res_name %in% deletable_res_name,]
dim(data)
```

#Processing missing data
```{r processing missing data, cache = TRUE}
#data <- data[complete.cases(data), ]
#dim(data)
```

#Data summary
```{r data summary}
#knitr::kable(summary(data))
dim(data)
```

#50 most popular ligands
```{r 50 most popular ligands}
# finding 50 most popular res_names
popular_names <- data %>% 
  select(res_name) %>% 
  group_by(res_name) %>% 
  summarise(cardinality = n()) %>% 
  arrange(-cardinality) %>% 
  slice(1:50)

# converting data frame format
popular_names_list <- as.list(popular_names[,"res_name"])$res_name

#limitation to popular ligands
data <- data[data$res_name %in% popular_names_list, ]
dim(data)
```

#Cardinality of ligands by name
```{r cardinality of ligands}
plot <- ggplot(popular_names, aes(x = reorder(res_name, -cardinality), y = cardinality, fill = cardinality)) +
  geom_bar(stat = "identity") +
  theme(axis.text.x = element_text(angle = 90)) +
  xlab("ligand")+
  labs(title = "Cardinality of ligands by name")

ggplotly(plot)
```
