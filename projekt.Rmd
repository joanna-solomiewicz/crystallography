---
title: "Projekt"
author: "Joanna So³omiewicz"
date: "15 listopada 2018"
output: 
  html_document: 
    theme: spacelab
    toc: yes
    toc_float: yes
---

#Pobieranie bibliotek
```{r pobieranie bibliotek, message = FALSE}
library(dplyr)
library(ggplot2)
library(plotly)
```

#Wczytywanie danych
```{r wczytywanie danych, cache = TRUE}
data <- read.csv2('./all_summary.csv', nrows = 10000)
dim(data)
```

#Usuniêcie wybranych wierszy
```{r usuniêcie wybranych wierszy}
deletable_res_name <- c("UNK", "UNX", "UNL", "DUM", "N", "BLOB", "ALA", "ARG", "ASN", "ASP", "CYS", "GLN", "GLU", "GLY", "HIS", "ILE", "LEU", "LYS", "MET", "MSE", "PHE", "PRO", "SEC", "SER", "THR", "TRP", "TYR", "VAL", "DA", "DG", "DT", "DC", "DU", "A", "G", "T", "C", "U", "HOH", "H20", "WAT")
data <- data[!data$res_name %in% deletable_res_name,]
dim(data)
```

#Wyczyszczenie danych z instancji pustych
```{r wyczyszczenie pustych danych, cache = TRUE}
#data <- data[complete.cases(data), ]
#dim(data)
```

#Podsumowanie danych
```{r podsumowanie danych}
#knitr::kable(summary(data))
dim(data)
```

#Najpopularniejsze
```{r najpopularniejsze}
# finding 50 most popular res_names
popular_res_names <- data %>% group_by(res_name) %>% summarise(n = n()) %>% arrange(-n) %>% slice(1:50)
# converting data frame format
popular_res_names <- as.list(popular_res_names[,1])$res_name
data <- data[data$res_name %in% popular_res_names,]
dim(data)
```

#Licznoœæ ligandów wed³ug nazwy
```{r licznoœæ ligandów}
count_by_name <- data %>% group_by(res_name) %>% summarise(cardinality = n()) %>% arrange(-cardinality)
count_by_name

plot <- ggplot(count_by_name, aes(x = reorder(res_name, -cardinality), y = cardinality, fill = cardinality)) +
  geom_bar(stat = "identity") +
  theme(axis.text.x = element_text(angle = 90)) +
  xlab("ligand")+
  labs(title = "Licznoœæ 50 najpopularniejszych ligandów wed³ug nazwy")

ggplotly(plot)
```

